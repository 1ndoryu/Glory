/* Interactive & Drag/Drop */
:root {
    /* --- Colors (RGB Components for RGBA usage) --- */
    --gbn-rgb-primary: 29, 143, 241;      /* Azul principal */
    --gbn-rgb-secondary: 245, 158, 11;    /* Naranja secundario */
    --gbn-rgb-green: 16, 185, 129;        /* Verde (PostRender, Input) */
    --gbn-rgb-purple: 139, 92, 246;       /* P√∫rpura (PostItem, Textarea) */
    --gbn-rgb-yellow: 251, 191, 36;       /* Amarillo (PostField) */
    --gbn-rgb-red: 239, 68, 68;           /* Rojo (Submit) */
    --gbn-rgb-blue-500: 59, 130, 246;     /* Blue (Form, DropLine) */
    --gbn-rgb-blue-600: 37, 99, 235;      /* Blue Darker (Hover) */
    --gbn-rgb-white: 255, 255, 255;
    
    /* --- Solid Colors --- */
    --gbn-color-white: #fff;
    --gbn-color-gray-bg: #f3f4f6;
    --gbn-color-gray-text: #374151;
    --gbn-color-gray-dark: #1f2937;
    --gbn-color-gray-darker: #111827;

    /* --- Dimensions --- */
    --gbn-radius-sm: 2px;
    --gbn-radius-md: 3px;
    --gbn-radius-base: 4px;
    --gbn-radius-lg: 6px;
    --gbn-radius-xl: 8px;
    --gbn-radius-full: 999px;

    /* --- Z-Indices --- */
    --gbn-z-badge: 5;
    --gbn-z-active: 10;
    --gbn-z-active-hover: 11;
    --gbn-z-controls: 90;
    --gbn-z-add-btn: 100;
    --gbn-z-dropdown: 100;
    --gbn-z-drop-line: 9999;
    --gbn-z-drag-proxy: 100000;
}

.gbn-node {
    position: relative;
}

.gbn-active .gbn-node {
    min-width: 20px;
    min-height: 20px;
}

.gbn-active [data-gbnPrincipal] {
    position: relative;
    outline: 1px dashed rgba(var(--gbn-rgb-primary), 0.35); /* Azul */
    outline-offset: 2px;
    transition: outline-color 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease;
}

.gbn-active [data-gbnSecundario] {
    position: relative;
    outline: 1px dashed rgba(var(--gbn-rgb-secondary), 0.35); /* Naranja */
    outline-offset: 2px;
    transition: outline-color 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease;
}

.gbn-active [data-gbnPrincipal]:hover {
    outline-color: rgba(var(--gbn-rgb-primary), 0.9);
    background-color: rgba(var(--gbn-rgb-primary), 0.08) !important; /* Force background */
    box-shadow: 0 0 0 2px rgba(var(--gbn-rgb-primary), 0.18);
    z-index: var(--gbn-z-active);
}

.gbn-active [data-gbnSecundario]:hover {
    outline-color: rgba(var(--gbn-rgb-secondary), 0.9);
    background-color: rgba(var(--gbn-rgb-secondary), 0.08) !important; /* Force background */
    box-shadow: 0 0 0 2px rgba(var(--gbn-rgb-secondary), 0.18);
    z-index: var(--gbn-z-active-hover);
}

.gbn-block {
    transition: outline-color 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
}

.gbn-block-active {
    outline-color: rgba(var(--gbn-rgb-primary), 0.9) !important;
    box-shadow: 0 0 0 2px rgba(var(--gbn-rgb-primary), 0.22);
    background-color: rgba(var(--gbn-rgb-primary), 0.06);
}

.gbn-block.gbn-loading::after {
    content: '';
    position: absolute;
    top: 10px;
    right: 16px;
    width: 14px;
    height: 14px;
    border-radius: var(--gbn-radius-full);
    border: 2px solid rgba(var(--gbn-rgb-primary), 0.4);
    border-top-color: rgba(var(--gbn-rgb-primary), 0.95);
    animation: gbn-spin 0.8s linear infinite;
}

.gbn-active .gbn-show-controls > .gbn-controls-group {
    opacity: 1;
    /* transform: translateY(-2px); Removed to fix centering */
}

.gbn-active .gbn-block-active > .gbn-controls-group {
    opacity: 1;
    /* transform: translateY(-2px); Removed to fix centering */
}

/* Cursor en los t√≠tulos de la lista para arrastrar */
.gbn-open .glory-split__titles .glory-split__title {
    cursor: grab;
}
.gbn-open .glory-split__titles .glory-split__title:active {
    cursor: grabbing;
}

/* Cursor y arrastre cuando est√° abierto */
.gbn-open .glory-content-item.is-drag {
    cursor: grabbing;
}

@keyframes gbn-spin {
    from {
        transform: rotate(0deg);
    }
    to {
        transform: rotate(360deg);
    }
}

/* Drag & Drop Styles */
.gbn-sortable-placeholder {
    background-color: rgba(var(--gbn-rgb-primary), 0.1);
    border: 2px dashed rgba(var(--gbn-rgb-primary), 0.5);
    margin: 10px 0;
    border-radius: var(--gbn-radius-base);
    pointer-events: none;
}

.gbn-node[draggable="true"] {
    cursor: grab;
}

.gbn-node[draggable="true"]:active {
    cursor: grabbing;
}

.gbn-node.is-dragging {
    opacity: 0.4;
}

/* Drag & Drop Indicators */
.gbn-drop-line {
    position: absolute;
    background-color: rgb(var(--gbn-rgb-blue-500)); /* Blue-500 */
    border-radius: var(--gbn-radius-sm);
    pointer-events: none;
    z-index: var(--gbn-z-drop-line);
    transition: all 0.1s ease-out;
    box-shadow: 0 0 4px rgba(var(--gbn-rgb-blue-500), 0.5);
}

.gbn-drop-line.horizontal {
    height: 4px;
    left: 0;
    right: 0;
    margin-top: -2px; /* Center on the edge */
}

.gbn-drop-line.vertical {
    width: 4px;
    top: 0;
    bottom: 0;
    margin-left: -2px; /* Center on the edge */
}

.gbn-node.is-dragging {
    opacity: 0.4;
    cursor: grabbing;
}

.gbn-node.gbn-drag-over {
    /* Highlight opcional para el contenedor siendo hovereado durante drag */
    /* Se activa via JavaScript cuando corresponde */
    outline: none; /* Placeholder para evitar ruleset vac√≠o */
}
.gbn-drag-proxy {
    position: absolute;
    top: -9999px;
    left: -9999px;
    z-index: var(--gbn-z-drag-proxy);
    pointer-events: none;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

/* Root Insertion Controls */
.gbn-root-controls {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none; /* Let clicks pass through to content */
    z-index: var(--gbn-z-controls);
    display: none; /* Controlled by JS */
}

.gbn-root-add-btn {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 24px;
    height: 24px;
    background-color: rgb(var(--gbn-rgb-blue-500));
    color: var(--gbn-color-white);
    border: none;
    border-radius: 50%;
    font-size: 18px;
    line-height: 1;
    cursor: pointer;
    pointer-events: auto; /* Re-enable clicks */
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    transition: transform 0.2s ease, background-color 0.2s ease;
    z-index: var(--gbn-z-add-btn);
    padding: unset;
    opacity: 0.8;
}

.gbn-root-add-btn:hover {
    background-color: rgb(var(--gbn-rgb-blue-600));
    transform: translateX(-50%) scale(1.1);
}

.gbn-root-add-top {
    top: -12px;
}

.gbn-root-add-bottom {
    bottom: -12px;
}

/* Width Control (Inspector) */
.gbn-width-control {
    position: relative;
    display: inline-block;
    margin: 0 2px;
}

.gbn-width-btn {
    appearance: none;
    border: 1px solid rgba(var(--gbn-rgb-white), 0.3);
    border-radius: var(--gbn-radius-base);
    background: rgba(var(--gbn-rgb-white), 0.1);
    color: var(--gbn-color-white);
    font-size: 11px;
    font-weight: 700;
    padding: 0 6px;
    height: 20px;
    min-width: 34px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.gbn-width-btn:hover {
    background: rgba(var(--gbn-rgb-white), 0.25);
    border-color: rgba(var(--gbn-rgb-white), 0.5);
}

.gbn-width-dropdown {
    position: absolute;
    bottom: 100%;
    left: 0;
    transform: translateY(-6px);
    background: var(--gbn-color-white);
    border-radius: var(--gbn-radius-lg); /* 6px was used, var is 6px? mapped 6px to lg */
    padding: 4px;
    width: 200px;
    display: none;
    z-index: var(--gbn-z-dropdown);
    max-height: 200px;
    overflow-y: unset;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); /* Keep shadow for visibility */
}

.gbn-width-dropdown.is-open {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 0px;
}

/* Bridge the gap between button and dropdown to prevent mouseout */
.gbn-width-dropdown::before {
    content: '';
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    height: 8px; /* Slightly larger than 6px to be safe */
    background: transparent;
}

.gbn-width-item {
    appearance: none;
    border: none;
    background: transparent;
    padding: 6px 2px; /* Reduced padding for 6 cols */
    font-size: 11px; /* Smaller font */
    color: var(--gbn-color-gray-text);
    cursor: pointer;
    border-radius: var(--gbn-radius-base);
    text-align: center;
    transition: background 0.1s;
    white-space: nowrap;
}

.gbn-width-item:hover {
    background: var(--gbn-color-gray-bg);
    color: var(--gbn-color-gray-darker);
}

/* Triangle for dropdown (Adjusted position) */
.gbn-width-dropdown::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 17px;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: var(--gbn-color-white) transparent transparent transparent;
    pointer-events: none; /* Let clicks pass through if needed */
    margin-top: 0px; /* Reset */
}

/* ============================================
   FASE 13: PostRender Components Styles
   ============================================ */

/* PostRender container loading state */
[gloryPostRender].gbn-loading {
    position: relative;
    min-height: 100px;
}

[gloryPostRender].gbn-loading::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(var(--gbn-rgb-white), 0.7);
    z-index: 10;
    border-radius: var(--gbn-radius-xl);
}

[gloryPostRender].gbn-loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 32px;
    height: 32px;
    margin: -16px 0 0 -16px;
    border-radius: var(--gbn-radius-full);
    border: 3px solid rgba(var(--gbn-rgb-primary), 0.3);
    border-top-color: rgba(var(--gbn-rgb-primary), 0.95);
    animation: gbn-spin 0.8s linear infinite;
    z-index: 11;
}

/* PostRender editor outline */
.gbn-active [gloryPostRender] {
    position: relative;
    outline: 2px dashed rgba(var(--gbn-rgb-green), 0.35); /* Verde */
    outline-offset: 4px;
    transition: outline-color 0.2s ease;
}

.gbn-active [gloryPostRender]:hover {
    outline-color: rgba(var(--gbn-rgb-green), 0.9);
}

/* PostItem editor outline */
.gbn-active [gloryPostItem] {
    position: relative;
    outline: 1px dashed rgba(var(--gbn-rgb-purple), 0.35); /* P√∫rpura */
    outline-offset: 2px;
    transition: outline-color 0.2s ease;
    overflow: visible; /* Permite que los badges de PostFields se muestren fuera */
}

.gbn-active [gloryPostItem]:hover {
    outline-color: rgba(var(--gbn-rgb-purple), 0.9);
}

/* PostItem template marker in editor */
/* El template ES editable - solo aplica estilo visual indicativo */
.gbn-active [data-gbn-is-template="true"] {
    position: relative;
    /* NO usar pointer-events: none aqu√≠ - el template debe ser editable */
}

.gbn-active [data-gbn-is-template="true"]::before {
    content: 'TEMPLATE (editable)';
    position: absolute;
    top: -10px;
    right: 4px; /* Derecha para no chocar con badges de PostFields */
    background: rgba(var(--gbn-rgb-purple), 0.9);
    color: var(--gbn-color-white);
    padding: 2px 8px;
    font-size: 10px;
    font-weight: bold;
    border-radius: var(--gbn-radius-base);
    z-index: var(--gbn-z-badge);
    white-space: nowrap;
}

/* PostField editor indicator */
.gbn-active [gloryPostField] {
    position: relative;
    background: rgba(var(--gbn-rgb-yellow), 0.1);
    border: 1px dashed rgba(var(--gbn-rgb-yellow), 0.4);
    border-radius: var(--gbn-radius-base);
    transition: all 0.2s ease;
    overflow: visible; /* Permite que el badge se muestre fuera del contenedor */
}

.gbn-active [gloryPostField]:hover {
    background: rgba(var(--gbn-rgb-yellow), 0.2);
    border-color: rgba(var(--gbn-rgb-yellow), 0.8);
}

/* PostField type badge */
.gbn-active [gloryPostField]::before {
    content: attr(gloryPostField);
    position: absolute;
    top: -10px;
    left: 4px;
    background: rgba(var(--gbn-rgb-yellow), 0.9);
    color: var(--gbn-color-gray-dark);
    padding: 1px 4px;
    font-size: 9px;
    font-weight: 600;
    border-radius: var(--gbn-radius-md);
    z-index: var(--gbn-z-badge);
    white-space: nowrap;
}

/* PostRender clones (preview items) - NO EDITABLES */
/* Los clones son solo visuales, se aplican estilos vi√° JS pero reforzamos aqu√≠ */
[data-gbn-pr-clone] {
    pointer-events: none !important; /* Reforzar: clones no interactivos */
    opacity: 0.85;
    cursor: default;
}

/* Preview message styles */
.gbn-pr-preview-message {
    grid-column: 1 / -1; /* Occupy full width in grid */
}

/* ============================================
   FASE 14: Form Components Editor Styles
   ============================================ */

/* Form container editor outline */
.gbn-active [gloryForm] {
    position: relative;
    outline: 2px dashed rgba(var(--gbn-rgb-blue-500), 0.35); /* Azul */
    outline-offset: 4px;
    background: rgba(var(--gbn-rgb-blue-500), 0.03);
    transition: outline-color 0.2s ease, background-color 0.2s ease;
    border-radius: var(--gbn-radius-xl);
}

.gbn-active [gloryForm]:hover {
    outline-color: rgba(var(--gbn-rgb-blue-500), 0.8);
    background: rgba(var(--gbn-rgb-blue-500), 0.06);
}

/* Form container badge */
.gbn-active [gloryForm]::before {
    content: 'üìã FORM';
    position: absolute;
    top: -10px;
    right: 4px;
    background: rgba(var(--gbn-rgb-blue-500), 0.9);
    color: var(--gbn-color-white);
    padding: 2px 8px;
    font-size: 10px;
    font-weight: bold;
    border-radius: var(--gbn-radius-base);
    z-index: var(--gbn-z-badge);
    white-space: nowrap;
}

/* Input field editor styles */
.gbn-active [gloryInput] {
    position: relative;
    background: rgba(var(--gbn-rgb-green), 0.06);
    border: 1px dashed rgba(var(--gbn-rgb-green), 0.35);
    border-radius: var(--gbn-radius-lg);
    transition: all 0.2s ease;
    overflow: visible;
    padding: 4px;
    margin: 2px 0;
}

.gbn-active [gloryInput]:hover {
    background: rgba(var(--gbn-rgb-green), 0.12);
    border-color: rgba(var(--gbn-rgb-green), 0.7);
}

/* Input badge */
.gbn-active [gloryInput]::before {
    content: 'INPUT';
    position: absolute;
    top: -8px;
    left: 4px;
    background: rgba(var(--gbn-rgb-green), 0.85);
    color: var(--gbn-color-white);
    padding: 1px 5px;
    font-size: 9px;
    font-weight: 600;
    border-radius: var(--gbn-radius-md);
    z-index: var(--gbn-z-badge);
    white-space: nowrap;
}

/* Textarea field editor styles */
.gbn-active [gloryTextarea] {
    position: relative;
    background: rgba(var(--gbn-rgb-purple), 0.06);
    border: 1px dashed rgba(var(--gbn-rgb-purple), 0.35);
    border-radius: var(--gbn-radius-lg);
    transition: all 0.2s ease;
    overflow: visible;
    padding: 4px;
    margin: 2px 0;
}

.gbn-active [gloryTextarea]:hover {
    background: rgba(var(--gbn-rgb-purple), 0.12);
    border-color: rgba(var(--gbn-rgb-purple), 0.7);
}

/* Textarea badge */
.gbn-active [gloryTextarea]::before {
    content: 'TEXTAREA';
    position: absolute;
    top: -8px;
    left: 4px;
    background: rgba(var(--gbn-rgb-purple), 0.85);
    color: var(--gbn-color-white);
    padding: 1px 5px;
    font-size: 9px;
    font-weight: 600;
    border-radius: var(--gbn-radius-md);
    z-index: var(--gbn-z-badge);
    white-space: nowrap;
}

/* Select field editor styles */
.gbn-active [glorySelect] {
    position: relative;
    background: rgba(var(--gbn-rgb-secondary), 0.06);
    border: 1px dashed rgba(var(--gbn-rgb-secondary), 0.35);
    border-radius: var(--gbn-radius-lg);
    transition: all 0.2s ease;
    overflow: visible;
    padding: 4px;
    margin: 2px 0;
}

.gbn-active [glorySelect]:hover {
    background: rgba(var(--gbn-rgb-secondary), 0.12);
    border-color: rgba(var(--gbn-rgb-secondary), 0.7);
}

/* Select badge */
.gbn-active [glorySelect]::before {
    content: 'SELECT';
    position: absolute;
    top: -8px;
    left: 4px;
    background: rgba(var(--gbn-rgb-secondary), 0.85);
    color: var(--gbn-color-gray-dark);
    padding: 1px 5px;
    font-size: 9px;
    font-weight: 600;
    border-radius: var(--gbn-radius-md);
    z-index: var(--gbn-z-badge);
    white-space: nowrap;
}

/* Submit button editor styles */
.gbn-active [glorySubmit] {
    position: relative;
    outline: 2px dashed rgba(var(--gbn-rgb-red), 0.35);
    outline-offset: 3px;
    transition: all 0.2s ease;
}

.gbn-active [glorySubmit]:hover {
    outline-color: rgba(var(--gbn-rgb-red), 0.8);
}

/* Submit badge - positioned outside the button */
.gbn-active [glorySubmit]::after {
    content: 'SUBMIT';
    position: absolute;
    top: -14px;
    right: 4px;
    background: rgba(var(--gbn-rgb-red), 0.9);
    color: var(--gbn-color-white);
    padding: 1px 5px;
    font-size: 9px;
    font-weight: 600;
    border-radius: var(--gbn-radius-md);
    z-index: var(--gbn-z-badge);
    white-space: nowrap;
}

/* Color coding summary for form components:
   - Form:     Azul (#3b82f6) - Contenedor principal
   - Input:    Verde (#10b981) - Campos de texto
   - Textarea: P√∫rpura (#8b5cf6) - √Årea de texto
   - Select:   Naranja (#f59e0b) - Selectores
   - Submit:   Rojo (#ef4444) - Botones de acci√≥n
*/
